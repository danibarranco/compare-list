<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Comparador de listas online ‚Äî eliminar duplicados y encontrar diferencias</title>
  <meta name="description" content="Comparador de listas gratuito. Pega dos listas, elimina duplicados, encuentra intersecciones y exporta. R√°pido, privado y sin instalaci√≥n.">
  <link rel="canonical" href="https://yourdomain.com/compare-list">
  <meta property="og:title" content="Comparador de listas online ‚Äî eliminar duplicados y encontrar diferencias">
  <meta property="og:description" content="Pega dos listas y obt√©n diferencias, intersecciones y duplicados al instante. Exporta CSV/JSON. R√°pido, privado y sin instalaciones.">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <script>
    window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
  </script>
  <script defer src="/_vercel/insights/script.js"></script>
  <style>
    :root{--bg:#f7f6fb;--surface:#ffffff;--muted:#6b6b6b;--text:#0f1720;--accent:#7c59f2;--card-shadow:0 8px 24px rgba(12,12,30,0.06);font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;margin:0}
    [data-theme="dark"]{--bg:#071025;--surface:#0b0f14;--muted:#95a0b8;--text:#e6eef8;--accent:#7c59f2;--card-shadow:none}
    body{padding:24px;background:var(--bg);color:var(--text);transition:background .2s ease,color .2s ease}
    h1{margin:0 0 12px}
    .container{max-width:1100px;margin:0 auto}
    .cols{display:grid;grid-template-columns:1fr 1fr;gap:32px;margin-bottom:18px;align-items:start}
    .cols > div{box-sizing:border-box}
    textarea{box-sizing:border-box}
    textarea{width:100%;min-height:240px;padding:16px;border-radius:10px;border:1px solid color-mix(in srgb,var(--surface) 60%, black 4%);resize:vertical;background:linear-gradient(180deg, color-mix(in srgb,var(--surface) 98%, black 1%), color-mix(in srgb,var(--surface) 95%, black 3%));box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);color:var(--text);font-family:monospace}
    /* add visual separation between inputs */
    .cols > div{padding:8px;background:linear-gradient(180deg, color-mix(in srgb,var(--surface) 94%, var(--bg) 6%), color-mix(in srgb,var(--surface) 90%, var(--bg) 10%));border-radius:12px;border:1px solid rgba(15,15,20,0.04)}
    .controls{margin:18px 0 6px;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    /* hide compare button when using realtime mode */
    .realtime .compare-btn{display:none}
    button{padding:10px 14px;border-radius:10px;border:none;background:var(--accent);color:white;cursor:pointer;box-shadow:var(--card-shadow);transition:transform .12s ease,box-shadow .12s}
    button:hover{transform:translateY(-2px);box-shadow:0 12px 30px rgba(107,92,231,0.18)}
    button.secondary{background:transparent;color:var(--muted);box-shadow:none;border:1px solid rgba(15,15,20,0.04);padding:8px 12px}
    .theme-toggle{margin-left:auto;background:transparent;border:1px solid rgba(15,15,20,0.06);padding:6px 10px;border-radius:8px;color:var(--muted);min-width:44px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer}
    .theme-toggle:hover{background:color-mix(in srgb,var(--surface) 94%, var(--accent) 2%)}
    .theme-toggle:focus{outline:2px solid color-mix(in srgb,var(--accent) 30%, transparent);outline-offset:3px}
    .results{margin-top:28px;display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    .controls{margin-bottom:18px}
    .card{background:var(--surface);padding:16px;border-radius:12px;box-shadow:var(--card-shadow);min-height:140px;border:1px solid color-mix(in srgb,var(--surface) 60%, black 6%)}
    /* remove heavy shadow in dark mode for flatter card */
    [data-theme="dark"] .card{box-shadow:none;border-color:color-mix(in srgb,var(--surface) 50%, black 12%)}
    .card h3{margin:0 0 8px;font-size:1rem;color:var(--text);font-weight:600}
    /* fixed card height with internal scroll for long content */
    .card{max-height:220px;display:flex;flex-direction:column}
    .card pre{flex:1;overflow:auto;padding-right:6px;color:var(--text)}
    /* ensure textarea fits within its parent and not overflow */
    .cols textarea{width:100%;height:220px}
    /* highlight center column */
    .card.center{background:linear-gradient(180deg,color-mix(in srgb,var(--accent) 10%, transparent 90%), color-mix(in srgb,var(--accent) 4%, transparent 96%));border:1px solid color-mix(in srgb,var(--accent) 20%, transparent);box-shadow:0 24px 60px color-mix(in srgb,var(--accent) 12%, rgba(0,0,0,0.12));transform:translateY(-4px)}
    .muted{color:var(--muted)}
    /* ensure cards align with inputs above */
    .results, .cols{max-width:1100px;margin:0 auto}
    pre{white-space:pre-wrap;margin:0;font-family:inherit;color:var(--text)}
    .footer{margin-top:22px;color:var(--muted);font-size:0.95rem}
    .small{font-size:0.9rem;color:var(--muted)}
    /* toast */
    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:28px;background:linear-gradient(180deg,color-mix(in srgb,var(--surface) 92%, var(--accent) 2%),var(--surface));padding:10px 14px;border-radius:12px;border:1px solid color-mix(in srgb,var(--surface) 60%, black 6%);box-shadow:0 12px 30px rgba(11,13,20,0.35);color:var(--text);display:none;z-index:999}
    [data-theme="dark"] .toast{box-shadow:none;border-color:color-mix(in srgb,var(--surface) 50%, black 18%)}
    .card .copied-note{font-size:0.8rem;color:color-mix(in srgb,var(--muted) 80%, var(--text) 20%);margin-top:0;display:inline-block}
    .card .actions{display:flex;align-items:center;gap:8px}

    @media (max-width:700px){
      .cols{grid-template-columns:1fr;gap:12px}
      .results{grid-template-columns:1fr}
    }
    /* Easter egg styles */
    #egg-overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:1200}
    #egg-modal{background:var(--surface);padding:20px;border-radius:12px;box-shadow:0 30px 80px rgba(15,15,30,0.4);max-width:480px;width:92%;text-align:center}
    #roulette{border-radius:50%}
    #roulette-result{font-weight:600}
  </style>
</head>
<body>
  <div class="container">
    <h1 id="title">Comparador de listas</h1>
    <p class="small">Pega una lista por l√≠nea en cada campo. Usa las opciones para normalizar elementos (trim, lowercase). La herramienta muestra diferencias, intersecciones y duplicados al instante. No requiere registro.</p>
    <!-- Structured data: FAQ + SoftwareApplication -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {"@type":"Question","name":"¬øLa herramienta guarda mis listas?","acceptedAnswer":{"@type":"Answer","text":"No, los datos solo quedan en tu navegador y no se env√≠an por defecto a ning√∫n servidor."}},
        {"@type":"Question","name":"¬øPuedo exportar los resultados?","acceptedAnswer":{"@type":"Answer","text":"S√≠ ‚Äî puedes copiar y pegar los resultados; en pr√≥ximas versiones a√±adiremos export a CSV/JSON."}},
        {"@type":"Question","name":"¬øFunciona en m√≥viles?","acceptedAnswer":{"@type":"Answer","text":"S√≠, la interfaz responde a pantallas peque√±as y puedes usarla desde el navegador m√≥vil."}},
        {"@type":"Question","name":"¬øLa comparaci√≥n distingue may√∫sculas?","acceptedAnswer":{"@type":"Answer","text":"Hay una opci√≥n 'Lowercase' para normalizar may√∫sculas/min√∫sculas antes de comparar."}}
      ]
    }
    </script>

    <!-- Hidden Easter egg: roulette modal (double-click title to open) -->
    <div id="egg-overlay" aria-hidden="true" style="display:none;">
      <div id="egg-modal" role="dialog" aria-modal="true" aria-labelledby="egg-title">
        <h2 id="egg-title" style="margin:0 0 12px">Ruleta secreta</h2>
        <canvas id="roulette" width="420" height="420" style="display:block;margin:0 auto;background:transparent"></canvas>
        <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
          <button id="spin">Girar</button>
          <button id="closeEgg" class="secondary">Cerrar</button>
        </div>
        <div id="roulette-result" aria-live="polite" style="text-align:center;margin-top:10px;color:var(--muted)"></div>
      </div>
    </div>

    <div class="cols">
    <div>
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px">
        <label><strong>Lista A</strong></label>
        <div style="display:flex;gap:8px;align-items:center">
          <span class="small">Total: <span id="totalA">0</span></span>
          <button id="clearA" class="secondary" title="Limpiar lista A">Limpiar A</button>
          <button id="sortA" class="secondary" title="Ordenar lista A">Ordenar A</button>
          <button id="dedupeA_top" class="secondary" title="Eliminar duplicados A">Eliminar duplicados A</button>
        </div>
      </div>
      <textarea id="listA" placeholder="Elemento 1\nElemento 2\n...">Manzana
Pera
Pl√°tano
pera
Kiwi
Manzana</textarea>
    </div>
    <div>
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px">
        <label><strong>Lista B</strong></label>
        <div style="display:flex;gap:8px;align-items:center">
          <span class="small">Total: <span id="totalB">0</span></span>
          <button id="clearB" class="secondary" title="Limpiar lista B">Limpiar B</button>
          <button id="sortB" class="secondary" title="Ordenar lista B">Ordenar B</button>
          <button id="dedupeB_top" class="secondary" title="Eliminar duplicados B">Eliminar duplicados B</button>
        </div>
      </div>
      <textarea id="listB" placeholder="Elemento 1\nElemento 2\n...">pera
Uva
Manzana
Pi√±a
kiwi
Mandarina</textarea>
    </div>
  </div>

  <div class="controls">
    <label class="small"><input type="checkbox" id="trim" checked> Trim</label>
    <label class="small"><input type="checkbox" id="lower" checked> Lowercase</label>
    <label class="small"><input type="checkbox" id="ignoreEmpty" checked> Ignorar l√≠neas vac√≠as</label>
    <button id="clear" class="secondary">Limpiar</button>
    <button id="swap" class="secondary">Intercambiar</button>
    <button id="themeToggle" class="theme-toggle" title="Alternar tema">Tema</button>
  </div>

  <div class="results">
    <div class="card">
      <h3 id="h3DiffA">Diferencias (A \ B) <span class="small" id="countDiffA">(0)</span></h3>
      <pre id="diffA">-</pre>
      <div class="actions"><button data-target="diffA" class="copy">Copiar</button></div>
    </div>
    <div class="card center">
      <h3 id="h3Inter">Intersecci√≥n <span class="small" id="countInter">(0)</span> <span class="muted" id="pctInter"></span></h3>
      <pre id="inter">-</pre>
      <div class="actions"><button data-target="inter" class="copy">Copiar</button></div>
    </div>
    <div class="card">
      <h3 id="h3DiffB">Diferencias (B \ A) <span class="small" id="countDiffB">(0)</span></h3>
      <pre id="diffB">-</pre>
      <div class="actions"><button data-target="diffB" class="copy">Copiar</button></div>
    </div>
  </div>

  <div class="results" style="margin-top:12px">
    <div class="card">
      <h3 id="h3DupsA">Duplicados A <span class="small" id="countDupsA">(0)</span></h3>
      <pre id="dupsA">-</pre>
      <div class="actions"><button data-target="dupsA" class="copy">Copiar</button></div>
    </div>
    <div class="card center">
      <h3 id="h3DupsAll">Duplicados (ambas) <span class="small" id="countDupsAll">(0)</span></h3>
      <pre id="dups">-</pre>
      <div class="actions"><button data-target="dups" class="copy">Copiar</button></div>
    </div>
    <div class="card">
      <h3 id="h3DupsB">Duplicados B <span class="small" id="countDupsB">(0)</span></h3>
      <pre id="dupsB">-</pre>
      <div class="actions"><button data-target="dupsB" class="copy">Copiar</button></div>
    </div>
  </div>

    <!-- Betting panel -->
    <div class="card" style="margin-top:14px">
      <h3>Panel de apuestas</h3>
      <div id="betting" style="display:flex;gap:16px;flex-wrap:wrap;align-items:flex-start">
        <div style="min-width:260px">
          <div class="small">Saldo: <strong id="balance">1000</strong> fichas</div>
          <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
            <div>
              <button class="chip" data-value="1">1</button>
              <button class="chip" data-value="5">5</button>
              <button class="chip" data-value="25">25</button>
              <button class="chip" data-value="100">100</button>
            </div>
            <div style="margin-left:8px">
              <input id="chipCustom" type="number" min="1" placeholder="Otra" style="width:80px;padding:6px;border-radius:6px;border:1px solid rgba(0,0,0,0.08)" />
            </div>
          </div>

          <div style="margin-top:10px">
            <label class="small">Tipo de apuesta</label>
            <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:6px">
              <button class="bet-type" data-type="color">Rojo/Negro</button>
              <button class="bet-type" data-type="par">Par/Impar</button>
              <button class="bet-type" data-type="half">Alta/Baja</button>
              <button class="bet-type" data-type="dozen">Docena</button>
              <button class="bet-type" data-type="column">Columna</button>
              <button class="bet-type" data-type="number">Pleno</button>
            </div>
          </div>
        </div>

        <div style="flex:1;min-width:260px">
          <div class="small">Apuestas activas</div>
          <div id="betsList" style="margin-top:8px;max-height:140px;overflow:auto;border:1px dashed rgba(0,0,0,0.05);padding:8px;border-radius:8px;background:linear-gradient(180deg,#fff,#fafafa)">(ninguna)</div>
          <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
            <div class="small">Total apostado: <strong id="totalBet">0</strong></div>
            <button id="clearBets" class="secondary">Limpiar apuestas</button>
            <button id="playSpin" style="margin-left:auto">GIRAR</button>
          </div>
        </div>
      </div>
    </div>

    <div class="footer"></div>
  </div>

  <script>
    function parse(text, opts){
      const lines = text.split(/\r?\n/);
      const out = [];
      for(let l of lines){
        if(opts.trim) l = l.trim();
        if(opts.lower) l = l.toLowerCase();
        if(opts.ignoreEmpty && l === '') continue;
        out.push(l);
      }
      return out;
    }

    function uniq(arr){
      return Array.from(new Set(arr));
    }

    function counts(arr){
      const m = new Map();
      for(const v of arr){ m.set(v, (m.get(v)||0)+1); }
      return m;
    }

    function compare(){
      const opts = {trim:document.getElementById('trim').checked, lower:document.getElementById('lower').checked, ignoreEmpty:document.getElementById('ignoreEmpty').checked}
      const aRaw = document.getElementById('listA').value;
      const bRaw = document.getElementById('listB').value;
      const a = parse(aRaw, opts);
      const b = parse(bRaw, opts);
      const setA = new Set(a);
      const setB = new Set(b);

      // totals (after normalization)
      document.getElementById('totalA').textContent = a.length;
      document.getElementById('totalB').textContent = b.length;

      const diffA = [...setA].filter(x=>!setB.has(x));
      const diffB = [...setB].filter(x=>!setA.has(x));
      const inter = [...setA].filter(x=>setB.has(x));

      const dupA = [...counts(a)].filter(([k,v])=>v>1).map(([k,v])=>`${k} (x${v})`);
      const dupB = [...counts(b)].filter(([k,v])=>v>1).map(([k,v])=>`${k} (x${v})`);
      const dupAll = uniq(dupA.concat(dupB));

      // helper to update panel content and reset copied state when content changes
      function setPanel(id, text){
        const el = document.getElementById(id);
        const prev = el.dataset.lastOutput || '';
        if(prev !== text){
          // content changed -> clear persisted copied state for this panel
          try{ localStorage.removeItem('listCompare.lastCopied'); }catch(e){}
          localStorage.removeItem(`listCompare.lastCopiedAt:${id}`);
          // reset any UI state for the copy button and note
          const btn = Array.from(document.querySelectorAll('.copy')).find(b=>b.dataset.target===id);
          if(btn){ btn.classList.remove('copied'); btn.innerText='Copiar'; const note = btn.closest('.actions')?.querySelector('.copied-note'); if(note) note.textContent=''; }
        }
        el.textContent = text;
        el.dataset.lastOutput = text;
      }
      setPanel('diffA', diffA.length?diffA.join('\n'):'(ninguno)');
      setPanel('diffB', diffB.length?diffB.join('\n'):'(ninguno)');
      setPanel('inter', inter.length?inter.join('\n'):'(ninguno)');
      setPanel('dupsA', dupA.length?dupA.join('\n'):'(ninguno)');
      setPanel('dupsB', dupB.length?dupB.join('\n'):'(ninguno)');
      setPanel('dups', dupAll.length?dupAll.join('\n'):'(ninguno)');

      // update counts in headings
      document.getElementById('countDiffA').textContent = `(${diffA.length})`;
      document.getElementById('countDiffB').textContent = `(${diffB.length})`;
      document.getElementById('countInter').textContent = `(${inter.length})`;
      // percentages relative to totals
      const pctA = a.length? Math.round((inter.length / a.length)*100) : 0;
      const pctB = b.length? Math.round((inter.length / b.length)*100) : 0;
      document.getElementById('pctInter').textContent = `‚Äî ${pctA}% de A ¬∑ ${pctB}% de B`;

      document.getElementById('countDupsA').textContent = `(${dupA.length})`;
      document.getElementById('countDupsB').textContent = `(${dupB.length})`;
      document.getElementById('countDupsAll').textContent = `(${dupAll.length})`;
    }

    const compareBtn = document.getElementById('compare');
    if(compareBtn) compareBtn.addEventListener('click', compare);
    document.getElementById('clear').addEventListener('click', ()=>{document.getElementById('listA').value='';document.getElementById('listB').value='';compare();});
    document.getElementById('swap').addEventListener('click', ()=>{const a = document.getElementById('listA').value;document.getElementById('listA').value = document.getElementById('listB').value;document.getElementById('listB').value = a;compare();});

    document.querySelectorAll('.copy').forEach(btn=>btn.addEventListener('click', async e=>{
      const targetId = e.currentTarget.dataset.target;
      const t = document.getElementById(targetId).textContent;
      const el = e.currentTarget;
      try{
        await navigator.clipboard.writeText(t);
        // persist which panel was copied and timestamp
        const now = Date.now();
        localStorage.setItem('listCompare.lastCopied', targetId);
        localStorage.setItem(`listCompare.lastCopiedAt:${targetId}`, String(now));
        // visual state: set copied class and show check on this button, clear others
        document.querySelectorAll('.copy').forEach(b=>{ b.classList.remove('copied'); if(b !== el) b.innerText='Copiar'; clearTimeout(b._revertTimer); });
        el.classList.add('copied');
        el.innerText = '‚úì Copiado';
        // schedule revert of button back to 'Copiar' after 2s, but keep the note persisted
        clearTimeout(el._revertTimer);
        el._revertTimer = setTimeout(()=>{ el.classList.remove('copied'); el.innerText='Copiar'; }, 2000);
        // update small note inside the card
        updateCardNote(targetId, now);
        // show toast
        showToast('Texto copiado al portapapeles');
      }catch(err){alert('No se pudo copiar. Usa selecci√≥n y ctrl+c');}
    }));
    // restore copied state on load if any
    (function restoreCopied(){
      const last = localStorage.getItem('listCompare.lastCopied');
      const TEN = 2000; // ms to keep button in 'copied' state
      if(last){
        const btn = Array.from(document.querySelectorAll('.copy')).find(b=>b.dataset.target===last);
        const at = localStorage.getItem(`listCompare.lastCopiedAt:${last}`);
        const age = at ? (Date.now() - Number(at)) : Infinity;
        // only show the button as 'copied' if within TEN ms; otherwise only show the note
        if(btn && age < TEN){ btn.classList.add('copied'); btn.innerText = '‚úì Copiado';
          // schedule revert
          clearTimeout(btn._revertTimer);
          btn._revertTimer = setTimeout(()=>{ btn.classList.remove('copied'); btn.innerText='Copiar'; }, TEN - age);
        }
      }
      // restore timestamps per card notes
      Array.from(document.querySelectorAll('.copy')).forEach(b=>{
        const target = b.dataset.target;
        const at = localStorage.getItem(`listCompare.lastCopiedAt:${target}`);
        if(at) updateCardNote(target, Number(at));
      });
    })();

    // basic toast helper
    function showToast(text, ms=2200){
      let t = document.getElementById('toast');
      if(!t){ t = document.createElement('div'); t.id='toast'; t.className='toast'; document.body.appendChild(t); }
      t.textContent = text;
      t.style.display = 'block';
      clearTimeout(t._timer);
      t._timer = setTimeout(()=>{ t.style.display='none'; }, ms);
    }
    function updateCardNote(targetId, ts){
      const el = document.querySelector(`[data-target="${targetId}"]`);
      if(!el) return;
      // find actions container
      const actions = el.closest('.actions');
      if(!actions) return;
      let note = actions.querySelector('.copied-note');
      if(!note){ note = document.createElement('div'); note.className='copied-note'; note.style.marginLeft='10px'; actions.appendChild(note); }
      const age = Math.floor((Date.now() - ts) / 1000);
      let txt = '';
      if(age < 60) txt = `hace ${age}s`;
      else if(age < 3600) txt = `hace ${Math.floor(age/60)}m`;
      else txt = `hace ${Math.floor(age/3600)}h`;
      note.textContent = txt;
    }

    // EASTER EGG: hidden roulette game (European 0‚Äì36) with sounds
    (function(){
      const title = document.getElementById('title');
      const overlay = document.getElementById('egg-overlay');
      const modal = document.getElementById('egg-modal');
      const canvas = document.getElementById('roulette');
      const spinBtn = document.getElementById('spin');
      const closeBtn = document.getElementById('closeEgg');
      const resultEl = document.getElementById('roulette-result');
      if(!title || !overlay || !canvas) return;
      // European roulette sequence (single zero) clockwise as on wheel (0 between 26 and 32 typically) ‚Äî we'll use numeric order 0..36 for simplicity
      const sectors = Array.from({length:37}, (_,i)=>String(i));
      // casino palette (alternating red/black) ‚Äî standard roulette reds set
      const redSet = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);
      const colors = i=> redSet.has(i)? '#b71c1c' : '#111111';

      const ctx = canvas.getContext('2d');
      const cx = canvas.width/2, cy = canvas.height/2, radius = Math.min(cx,cy)-8;

      function drawWheel(){
        const seg = 2*Math.PI / sectors.length;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        // outer rim (gold)
        ctx.beginPath(); ctx.arc(cx,cy,radius+12,0,Math.PI*2); ctx.fillStyle='#b88700'; ctx.fill();
        // wheel background
        ctx.beginPath(); ctx.arc(cx,cy,radius+6,0,Math.PI*2); ctx.fillStyle='#2b2b2b'; ctx.fill();
        for(let i=0;i<sectors.length;i++){
          const start = i*seg; const end = start+seg;
          ctx.beginPath(); ctx.moveTo(cx,cy); ctx.arc(cx,cy,radius,start,end); ctx.closePath();
          ctx.fillStyle = colors(Number(sectors[i])); ctx.fill();
          // separator
          ctx.strokeStyle = '#e6c07b'; ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(cx,cy); ctx.arc(cx,cy,radius,start,end); ctx.stroke();
          // labels (numbers)
          ctx.save(); ctx.translate(cx,cy); ctx.rotate(start + seg/2);
          ctx.fillStyle = '#fff'; ctx.font='16px Inter, monospace'; ctx.textAlign='center';
          // small badge for number
          ctx.beginPath(); ctx.fillStyle='rgba(0,0,0,0.25)'; ctx.arc(radius-36,0,20,0,Math.PI*2); ctx.fill();
          ctx.fillStyle = '#fff'; ctx.fillText(sectors[i], radius-36, 6);
          ctx.restore();
        }
        // inner circles
        ctx.beginPath(); ctx.arc(cx,cy,44,0,Math.PI*2); ctx.fillStyle='#111'; ctx.fill();
        ctx.beginPath(); ctx.arc(cx,cy,34,0,Math.PI*2); ctx.fillStyle='#b88700'; ctx.fill();
        // pointer (top)
        ctx.fillStyle = '#e6c07b'; ctx.beginPath(); ctx.moveTo(cx,cy-radius-20); ctx.lineTo(cx-14,cy-radius-50); ctx.lineTo(cx+14,cy-radius-50); ctx.closePath(); ctx.fill();
        // center pin
        ctx.beginPath(); ctx.arc(cx,cy,6,0,Math.PI*2); ctx.fillStyle='#b71c1c'; ctx.fill();
      }

      // simple WebAudio click + fanfare synthesis (no external files)
      const AudioCtx = window.AudioContext || window.webkitAudioContext;
      let audioCtx;
      function ensureAudio(){ if(!audioCtx) audioCtx = new AudioCtx(); }
      function clickTick(time, gain=0.15){
        ensureAudio();
        const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
        o.type = 'square'; o.frequency.setValueAtTime(1200, time);
        g.gain.setValueAtTime(gain, time);
        g.gain.exponentialRampToValueAtTime(0.001, time+0.06);
        o.connect(g); g.connect(audioCtx.destination);
        o.start(time); o.stop(time+0.07);
      }
      function fanfare(){
        ensureAudio();
        const now = audioCtx.currentTime;
        const freqs = [880, 1100, 1320];
        freqs.forEach((f,i)=>{
          const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
          o.type='sine'; o.frequency.setValueAtTime(f, now + i*0.08);
          g.gain.setValueAtTime(0.0001, now + i*0.08);
          g.gain.exponentialRampToValueAtTime(0.2, now + i*0.08 + 0.02);
          g.gain.exponentialRampToValueAtTime(0.001, now + i*0.08 + 0.6);
          o.connect(g); g.connect(audioCtx.destination);
          o.start(now + i*0.08); o.stop(now + i*0.08 + 0.8);
        });
      }

      let spinning=false;
      function spin(){
        if(spinning) return; spinning=true; resultEl.textContent='';
        // total rotation degrees (multiple spins + random offset)
        const total = 360 * (6 + Math.floor(Math.random()*3)) + (Math.random()*360);
        const duration = 4500 + Math.random()*2500;
        const start = performance.now();
        const initial = 0;

        // schedule audio ticks during spin using WebAudio clock for consistency
        ensureAudio();
        const startAudio = audioCtx.currentTime + 0.02; // small offset
        const tickCount = Math.max(8, Math.floor(duration/80));
        // we'll schedule ticks that speed down: compute times
        const tickTimes = [];
        for(let i=0;i<tickCount;i++){
          // ease-out spacing
          const t = i/(tickCount-1);
          const spaced = startAudio + (duration/1000) * (1 - Math.pow(1-t,3));
          tickTimes.push(spaced);
        }
        tickTimes.forEach((tt,idx)=> clickTick(tt, 0.07 + Math.random()*0.06));

        function frame(now){
          const t = Math.min(1,(now-start)/duration);
          const ease = 1 - Math.pow(1-t,3);
          const angle = (initial + total*ease) % 360;
          canvas.style.transform = `rotate(${angle}deg)`;
          if(t<1) requestAnimationFrame(frame);
          else{
            spinning=false;
            const finalAngle = (angle%360);
            const degPer = 360/sectors.length;
            const index = Math.floor(((360 - finalAngle + degPer/2) % 360)/degPer) % sectors.length;
            const val = sectors[index];
            resultEl.textContent = val;
            // celebratory fanfare for non-zero hits
            fanfare();
          }
        }
        requestAnimationFrame(frame);
      }

      drawWheel();
      // handlers
      title.addEventListener('dblclick', ()=>{ overlay.style.display='flex'; overlay.setAttribute('aria-hidden','false'); });
      closeBtn.addEventListener('click', ()=>{ overlay.style.display='none'; overlay.setAttribute('aria-hidden','true'); });
      spinBtn.addEventListener('click', spin);
      // allow Esc to close
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ overlay.style.display='none'; overlay.setAttribute('aria-hidden','true'); } });
    })();

    // theme handling: detect prefers-color-scheme and allow toggle
    const themeToggle = document.getElementById('themeToggle');
    function applyTheme(t){
      if(t === 'dark') document.documentElement.setAttribute('data-theme','dark');
      else document.documentElement.removeAttribute('data-theme');
    }
    // initial: from localStorage or prefers
    const saved = localStorage.getItem('listCompareTheme');
    if(saved){ applyTheme(saved); }
    else if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){ applyTheme('dark'); }

    function updateThemeButton(){
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
      themeToggle.setAttribute('aria-label', isDark ? 'Cambiar a claro' : 'Cambiar a oscuro');
    }
    themeToggle.addEventListener('click', ()=>{
      const now = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      applyTheme(now);
      localStorage.setItem('listCompareTheme', now);
      updateThemeButton();
    });
    // initialize theme button state
    updateThemeButton();

    // Debounced real-time compare: run compare on input changes
    const taA = document.getElementById('listA');
    const taB = document.getElementById('listB');
    function debounce(fn, wait){ let t; return function(...args){ clearTimeout(t); t = setTimeout(()=>fn.apply(this,args), wait); }; }
    const debouncedCompare = debounce(()=>{ compare(); }, 300);
    // enable realtime mode (adds class to container to hide compare button)
    document.querySelector('.container').classList.add('realtime');
    // attach input listeners to textareas to trigger debounced compare and update totals in real time
    taA.addEventListener('input', ()=>{ debouncedCompare(); });
    taB.addEventListener('input', ()=>{ debouncedCompare(); });
    // also handle paste/drop to run compare immediately
    taA.addEventListener('paste', ()=>{ setTimeout(compare, 50); });
    taB.addEventListener('paste', ()=>{ setTimeout(compare, 50); });
    taA.addEventListener('drop', ()=>{ setTimeout(compare, 50); });
    taB.addEventListener('drop', ()=>{ setTimeout(compare, 50); });

    // ensure initial compare runs after DOM ready
    window.addEventListener('load', compare);

    // refresh per-card "√öltimo" notes every 10s
    setInterval(()=>{
      Array.from(document.querySelectorAll('.copy')).forEach(b=>{
        const target = b.dataset.target;
        const at = localStorage.getItem(`listCompare.lastCopiedAt:${target}`);
        if(at) updateCardNote(target, Number(at));
      });
    }, 10000);

    // clear individual lists
    document.getElementById('clearA').addEventListener('click', ()=>{document.getElementById('listA').value=''; compare();});
    document.getElementById('clearB').addEventListener('click', ()=>{document.getElementById('listB').value=''; compare();});

    // remove duplicates from a list (keep first occurrence) ‚Äî moved to top controls
    document.getElementById('dedupeA_top').addEventListener('click', ()=>{
      const opts = {trim:document.getElementById('trim').checked, lower:document.getElementById('lower').checked, ignoreEmpty:document.getElementById('ignoreEmpty').checked};
      const a = parse(document.getElementById('listA').value, opts);
      const unique = uniq(a);
      document.getElementById('listA').value = unique.join('\n');
      compare();
    });
    document.getElementById('dedupeB_top').addEventListener('click', ()=>{
      const opts = {trim:document.getElementById('trim').checked, lower:document.getElementById('lower').checked, ignoreEmpty:document.getElementById('ignoreEmpty').checked};
      const b = parse(document.getElementById('listB').value, opts);
      const unique = uniq(b);
      document.getElementById('listB').value = unique.join('\n');
      compare();
    });

    // sort list A/B (alphabetical)
    document.getElementById('sortA').addEventListener('click', ()=>{
      const opts = {trim:document.getElementById('trim').checked, lower:document.getElementById('lower').checked, ignoreEmpty:document.getElementById('ignoreEmpty').checked};
      const a = parse(document.getElementById('listA').value, opts);
      a.sort((x,y)=>x.localeCompare(y, undefined, {sensitivity: 'base'}));
      document.getElementById('listA').value = a.join('\n');
      compare();
    });
    document.getElementById('sortB').addEventListener('click', ()=>{
      const opts = {trim:document.getElementById('trim').checked, lower:document.getElementById('lower').checked, ignoreEmpty:document.getElementById('ignoreEmpty').checked};
      const b = parse(document.getElementById('listB').value, opts);
      b.sort((x,y)=>x.localeCompare(y, undefined, {sensitivity: 'base'}));
      document.getElementById('listB').value = b.join('\n');
      compare();
    });

    // initial compare
    compare();
  </script>
</body>
</html>